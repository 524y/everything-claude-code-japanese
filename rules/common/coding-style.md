# コーディングスタイル

## Immutability（CRITICAL）

既存オブジェクトを破壊的変更せず、新しい値を返す:

```
WRONG:  modify(original, field, value) -> original を変更
CORRECT: update(original, field, value) -> 変更を反映した新しいコピーを返す
```

## ファイル構成

MANY SMALL FILES > FEW LARGE FILES:
- 高凝集・低結合
- 200-400 行を目安、最大 800 行
- 大きいモジュールは utility を抽出
- 型別ではなく機能 / ドメイン別に整理

## エラーハンドリング

- 各レイヤーで明示的にエラー処理
- UI 側はユーザー向けメッセージ
- サーバー側は詳細コンテキストをログ
- エラーを黙って握りつぶさない

## 入力検証

- 境界（API / 外部入力）で必ず検証
- 可能ならスキーマベース検証を使う
- 明確なエラーで fail fast
- 外部データは常に不正を前提に扱う

## 品質チェックリスト

- [ ] 命名と可読性が十分
- [ ] 関数は小さい（50 行未満）
- [ ] ファイルは責務集中（800 行未満）
- [ ] 深いネストがない（4 段以下）
- [ ] 適切なエラーハンドリング
- [ ] ハードコード値を避ける
- [ ] 破壊的変更を避ける
