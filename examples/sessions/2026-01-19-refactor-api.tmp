# セッション: API リファクタ - エラー処理
**日付:** 2026-01-19
**開始:** 10:00
**最終更新:** 13:30

---

## 現在の状況

全 API エンドポイントのエラー処理を標準化中。場当たり的な try/catch から集中管理のエラーミドルウェアへ移行している。

### 完了
- [x] ステータスコード付きの AppError クラスを作成
- [x] グローバルエラーハンドラーのミドルウェアを構築
- [x] `/users` ルートを新パターンに移行
- [x] `/products` ルートを移行

### 重要な発見
- 47 個のエンドポイントでエラーレスポンスが不統一
- 一部は `{ error: message }` を返し、別の一部は `{ message: message }` を返す
- HTTP ステータスコードが一貫していない

### エラーレスポンス標準
```javascript
{
  success: false,
  error: {
    code: 'VALIDATION_ERROR',
    message: 'Email is required',
    field: 'email'  // 任意、バリデーションエラー向け
  }
}
```

### 次セッションのメモ
- 残りのルートを移行: `/orders`、`/payments`、`/admin`
- 監視サービスにエラーログを追加する

### 読み込むコンテキスト
```
src/middleware/errorHandler.js
src/utils/AppError.js
```
